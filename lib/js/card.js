(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
// Generated by CoffeeScript 1.7.1
(function() {
  var $, cardFromNumber, cardFromType, cards, defaultFormat, formatBackCardNumber, formatBackExpiry, formatCardNumber, formatExpiry, formatForwardExpiry, formatForwardSlash, hasTextSelected, luhnCheck, reFormatCardNumber, restrictCVC, restrictCardNumber, restrictExpiry, restrictNumeric, setCardType,
    __slice = [].slice,
    __indexOf = [].indexOf || function(item) { for (var i = 0, l = this.length; i < l; i++) { if (i in this && this[i] === item) return i; } return -1; };

  $ = jQuery;

  $.payment = {};

  $.payment.fn = {};

  $.fn.payment = function() {
    var args, method;
    method = arguments[0], args = 2 <= arguments.length ? __slice.call(arguments, 1) : [];
    return $.payment.fn[method].apply(this, args);
  };

  defaultFormat = /(\d{1,4})/g;

  cards = [
    {
      type: 'maestro',
      pattern: /^(5018|5020|5038|6304|6759|676[1-3])/,
      format: defaultFormat,
      length: [12, 13, 14, 15, 16, 17, 18, 19],
      cvcLength: [3],
      luhn: true
    }, {
      type: 'dinersclub',
      pattern: /^(36|38|30[0-5])/,
      format: defaultFormat,
      length: [14],
      cvcLength: [3],
      luhn: true
    }, {
      type: 'laser',
      pattern: /^(6706|6771|6709)/,
      format: defaultFormat,
      length: [16, 17, 18, 19],
      cvcLength: [3],
      luhn: true
    }, {
      type: 'jcb',
      pattern: /^35/,
      format: defaultFormat,
      length: [16],
      cvcLength: [3],
      luhn: true
    }, {
      type: 'unionpay',
      pattern: /^62/,
      format: defaultFormat,
      length: [16, 17, 18, 19],
      cvcLength: [3],
      luhn: false
    }, {
      type: 'discover',
      pattern: /^(6011|65|64[4-9]|622)/,
      format: defaultFormat,
      length: [16],
      cvcLength: [3],
      luhn: true
    }, {
      type: 'mastercard',
      pattern: /^5[1-5]/,
      format: defaultFormat,
      length: [16],
      cvcLength: [3],
      luhn: true
    }, {
      type: 'amex',
      pattern: /^3[47]/,
      format: /(\d{1,4})(\d{1,6})?(\d{1,5})?/,
      length: [15],
      cvcLength: [3, 4],
      luhn: true
    }, {
      type: 'visa',
      pattern: /^4/,
      format: defaultFormat,
      length: [13, 16],
      cvcLength: [3],
      luhn: true
    }
  ];

  cardFromNumber = function(num) {
    var card, _i, _len;
    num = (num + '').replace(/\D/g, '');
    for (_i = 0, _len = cards.length; _i < _len; _i++) {
      card = cards[_i];
      if (card.pattern.test(num)) {
        return card;
      }
    }
  };

  cardFromType = function(type) {
    var card, _i, _len;
    for (_i = 0, _len = cards.length; _i < _len; _i++) {
      card = cards[_i];
      if (card.type === type) {
        return card;
      }
    }
  };

  luhnCheck = function(num) {
    var digit, digits, odd, sum, _i, _len;
    odd = true;
    sum = 0;
    digits = (num + '').split('').reverse();
    for (_i = 0, _len = digits.length; _i < _len; _i++) {
      digit = digits[_i];
      digit = parseInt(digit, 10);
      if ((odd = !odd)) {
        digit *= 2;
      }
      if (digit > 9) {
        digit -= 9;
      }
      sum += digit;
    }
    return sum % 10 === 0;
  };

  hasTextSelected = function($target) {
    var _ref;
    if (($target.prop('selectionStart') != null) && $target.prop('selectionStart') !== $target.prop('selectionEnd')) {
      return true;
    }
    if (typeof document !== "undefined" && document !== null ? (_ref = document.selection) != null ? typeof _ref.createRange === "function" ? _ref.createRange().text : void 0 : void 0 : void 0) {
      return true;
    }
    return false;
  };

  reFormatCardNumber = function(e) {
    return setTimeout((function(_this) {
      return function() {
        var $target, value;
        $target = $(e.currentTarget);
        value = $target.val();
        value = $.payment.formatCardNumber(value);
        return $target.val(value);
      };
    })(this));
  };

  formatCardNumber = function(e) {
    var $target, card, digit, length, re, upperLength, value;
    digit = String.fromCharCode(e.which);
    if (!/^\d+$/.test(digit)) {
      return;
    }
    $target = $(e.currentTarget);
    value = $target.val();
    card = cardFromNumber(value + digit);
    length = (value.replace(/\D/g, '') + digit).length;
    upperLength = 16;
    if (card) {
      upperLength = card.length[card.length.length - 1];
    }
    if (length >= upperLength) {
      return;
    }
    if (($target.prop('selectionStart') != null) && $target.prop('selectionStart') !== value.length) {
      return;
    }
    if (card && card.type === 'amex') {
      re = /^(\d{4}|\d{4}\s\d{6})$/;
    } else {
      re = /(?:^|\s)(\d{4})$/;
    }
    if (re.test(value)) {
      e.preventDefault();
      return $target.val(value + ' ' + digit);
    } else if (re.test(value + digit)) {
      e.preventDefault();
      return $target.val(value + digit + ' ');
    }
  };

  formatBackCardNumber = function(e) {
    var $target, value;
    $target = $(e.currentTarget);
    value = $target.val();
    if (e.meta) {
      return;
    }
    if (e.which !== 8) {
      return;
    }
    if (($target.prop('selectionStart') != null) && $target.prop('selectionStart') !== value.length) {
      return;
    }
    if (/\d\s$/.test(value)) {
      e.preventDefault();
      return $target.val(value.replace(/\d\s$/, ''));
    } else if (/\s\d?$/.test(value)) {
      e.preventDefault();
      return $target.val(value.replace(/\s\d?$/, ''));
    }
  };

  formatExpiry = function(e) {
    var $target, digit, val;
    digit = String.fromCharCode(e.which);
    if (!/^\d+$/.test(digit)) {
      return;
    }
    $target = $(e.currentTarget);
    val = $target.val() + digit;
    if (/^\d$/.test(val) && (val !== '0' && val !== '1')) {
      e.preventDefault();
      return $target.val("0" + val + " / ");
    } else if (/^\d\d$/.test(val)) {
      e.preventDefault();
      return $target.val("" + val + " / ");
    }
  };

  formatForwardExpiry = function(e) {
    var $target, digit, val;
    digit = String.fromCharCode(e.which);
    if (!/^\d+$/.test(digit)) {
      return;
    }
    $target = $(e.currentTarget);
    val = $target.val();
    if (/^\d\d$/.test(val)) {
      return $target.val("" + val + " / ");
    }
  };

  formatForwardSlash = function(e) {
    var $target, slash, val;
    slash = String.fromCharCode(e.which);
    if (slash !== '/') {
      return;
    }
    $target = $(e.currentTarget);
    val = $target.val();
    if (/^\d$/.test(val) && val !== '0') {
      return $target.val("0" + val + " / ");
    }
  };

  formatBackExpiry = function(e) {
    var $target, value;
    if (e.meta) {
      return;
    }
    $target = $(e.currentTarget);
    value = $target.val();
    if (e.which !== 8) {
      return;
    }
    if (($target.prop('selectionStart') != null) && $target.prop('selectionStart') !== value.length) {
      return;
    }
    if (/\d(\s|\/)+$/.test(value)) {
      e.preventDefault();
      return $target.val(value.replace(/\d(\s|\/)*$/, ''));
    } else if (/\s\/\s?\d?$/.test(value)) {
      e.preventDefault();
      return $target.val(value.replace(/\s\/\s?\d?$/, ''));
    }
  };

  restrictNumeric = function(e) {
    var input;
    if (e.metaKey || e.ctrlKey) {
      return true;
    }
    if (e.which === 32) {
      return false;
    }
    if (e.which === 0) {
      return true;
    }
    if (e.which < 33) {
      return true;
    }
    input = String.fromCharCode(e.which);
    return !!/[\d\s]/.test(input);
  };

  restrictCardNumber = function(e) {
    var $target, card, digit, value;
    $target = $(e.currentTarget);
    digit = String.fromCharCode(e.which);
    if (!/^\d+$/.test(digit)) {
      return;
    }
    if (hasTextSelected($target)) {
      return;
    }
    value = ($target.val() + digit).replace(/\D/g, '');
    card = cardFromNumber(value);
    if (card) {
      return value.length <= card.length[card.length.length - 1];
    } else {
      return value.length <= 16;
    }
  };

  restrictExpiry = function(e) {
    var $target, digit, value;
    $target = $(e.currentTarget);
    digit = String.fromCharCode(e.which);
    if (!/^\d+$/.test(digit)) {
      return;
    }
    if (hasTextSelected($target)) {
      return;
    }
    value = $target.val() + digit;
    value = value.replace(/\D/g, '');
    if (value.length > 6) {
      return false;
    }
  };

  restrictCVC = function(e) {
    var $target, digit, val;
    $target = $(e.currentTarget);
    digit = String.fromCharCode(e.which);
    if (!/^\d+$/.test(digit)) {
      return;
    }
    if (hasTextSelected($target)) {
      return;
    }
    val = $target.val() + digit;
    return val.length <= 4;
  };

  setCardType = function(e) {
    var $target, allTypes, card, cardType, val;
    $target = $(e.currentTarget);
    val = $target.val();
    cardType = $.payment.cardType(val) || 'unknown';
    if (!$target.hasClass(cardType)) {
      allTypes = (function() {
        var _i, _len, _results;
        _results = [];
        for (_i = 0, _len = cards.length; _i < _len; _i++) {
          card = cards[_i];
          _results.push(card.type);
        }
        return _results;
      })();
      $target.removeClass('unknown');
      $target.removeClass(allTypes.join(' '));
      $target.addClass(cardType);
      $target.toggleClass('identified', cardType !== 'unknown');
      return $target.trigger('payment.cardType', cardType);
    }
  };

  $.payment.fn.formatCardCVC = function() {
    this.payment('restrictNumeric');
    this.on('keypress', restrictCVC);
    return this;
  };

  $.payment.fn.formatCardExpiry = function() {
    this.payment('restrictNumeric');
    this.on('keypress', restrictExpiry);
    this.on('keypress', formatExpiry);
    this.on('keypress', formatForwardSlash);
    this.on('keypress', formatForwardExpiry);
    this.on('keydown', formatBackExpiry);
    return this;
  };

  $.payment.fn.formatCardNumber = function() {
    this.payment('restrictNumeric');
    this.on('keypress', restrictCardNumber);
    this.on('keypress', formatCardNumber);
    this.on('keydown', formatBackCardNumber);
    this.on('keyup', setCardType);
    this.on('paste', reFormatCardNumber);
    return this;
  };

  $.payment.fn.restrictNumeric = function() {
    this.on('keypress', restrictNumeric);
    return this;
  };

  $.payment.fn.cardExpiryVal = function() {
    return $.payment.cardExpiryVal($(this).val());
  };

  $.payment.cardExpiryVal = function(value) {
    var month, prefix, year, _ref;
    value = value.replace(/\s/g, '');
    _ref = value.split('/', 2), month = _ref[0], year = _ref[1];
    if ((year != null ? year.length : void 0) === 2 && /^\d+$/.test(year)) {
      prefix = (new Date).getFullYear();
      prefix = prefix.toString().slice(0, 2);
      year = prefix + year;
    }
    month = parseInt(month, 10);
    year = parseInt(year, 10);
    return {
      month: month,
      year: year
    };
  };

  $.payment.validateCardNumber = function(num) {
    var card, _ref;
    num = (num + '').replace(/\s+|-/g, '');
    if (!/^\d+$/.test(num)) {
      return false;
    }
    card = cardFromNumber(num);
    if (!card) {
      return false;
    }
    return (_ref = num.length, __indexOf.call(card.length, _ref) >= 0) && (card.luhn === false || luhnCheck(num));
  };

  $.payment.validateCardExpiry = (function(_this) {
    return function(month, year) {
      var currentTime, expiry, prefix, _ref;
      if (typeof month === 'object' && 'month' in month) {
        _ref = month, month = _ref.month, year = _ref.year;
      }
      if (!(month && year)) {
        return false;
      }
      month = $.trim(month);
      year = $.trim(year);
      if (!/^\d+$/.test(month)) {
        return false;
      }
      if (!/^\d+$/.test(year)) {
        return false;
      }
      if (!(parseInt(month, 10) <= 12)) {
        return false;
      }
      if (year.length === 2) {
        prefix = (new Date).getFullYear();
        prefix = prefix.toString().slice(0, 2);
        year = prefix + year;
      }
      expiry = new Date(year, month);
      currentTime = new Date;
      expiry.setMonth(expiry.getMonth() - 1);
      expiry.setMonth(expiry.getMonth() + 1, 1);
      return expiry > currentTime;
    };
  })(this);

  $.payment.validateCardCVC = function(cvc, type) {
    var _ref, _ref1;
    cvc = $.trim(cvc);
    if (!/^\d+$/.test(cvc)) {
      return false;
    }
    if (type) {
      return _ref = cvc.length, __indexOf.call((_ref1 = cardFromType(type)) != null ? _ref1.cvcLength : void 0, _ref) >= 0;
    } else {
      return cvc.length >= 3 && cvc.length <= 4;
    }
  };

  $.payment.cardType = function(num) {
    var _ref;
    if (!num) {
      return null;
    }
    return ((_ref = cardFromNumber(num)) != null ? _ref.type : void 0) || null;
  };

  $.payment.formatCardNumber = function(num) {
    var card, groups, upperLength, _ref;
    card = cardFromNumber(num);
    if (!card) {
      return num;
    }
    upperLength = card.length[card.length.length - 1];
    num = num.replace(/\D/g, '');
    num = num.slice(0, +upperLength + 1 || 9e9);
    if (card.format.global) {
      return (_ref = num.match(card.format)) != null ? _ref.join(' ') : void 0;
    } else {
      groups = card.format.exec(num);
      if (groups != null) {
        groups.shift();
      }
      return groups != null ? groups.join(' ') : void 0;
    }
  };

}).call(this);

},{}],2:[function(require,module,exports){
var $, Card,
  __slice = [].slice;

require('jquery.payment');

$ = jQuery;

$.card = {};

$.card.fn = {};

$.fn.card = function(opts) {
  return $.card.fn.construct.apply(this, opts);
};

Card = (function() {
  var validToggler;

  Card.prototype.template = "<div class=\"card-container\">\n    <div class=\"card\">\n        <div class=\"front\">\n                <div class=\"logo visa\">visa</div>\n                <div class=\"logo mastercard\">MasterCard</div>\n                <div class=\"logo amex\"></div>\n                <div class=\"logo discover\">discover</div>\n            <div class=\"lower\">\n                <div class=\"shiny\"></div>\n                <div class=\"cvc display\">••••</div>\n                <div class=\"number display\">•••• •••• •••• ••••</div>\n                <div class=\"name display\">Full name</div>\n                <div class=\"expiry display\">••/••</div>\n            </div>\n        </div>\n        <div class=\"back\">\n            <div class=\"bar\"></div>\n            <div class=\"cvc display\">•••</div>\n            <div class=\"shiny\"></div>\n        </div>\n    </div>\n</div>";

  Card.prototype.cardTypes = ['maestro', 'dinersclub', 'laser', 'jcb', 'unionpay', 'discover', 'mastercard', 'amex', 'visa'];

  Card.prototype.defaults = {
    formatting: true,
    formSelectors: {
      numberInput: 'input[name="number"]',
      expiryInput: 'input[name="expiry"]',
      cvcInput: 'input[name="cvc"]',
      nameInput: 'input[name="name"]'
    },
    cardSelectors: {
      cardContainer: '.card-container',
      card: '.card',
      numberDisplay: '.number',
      expiryDisplay: '.expiry',
      cvcDisplay: '.cvc',
      nameDisplay: '.name'
    }
  };

  function Card(el, opts) {
    this.options = $.extend({}, this.defaults, opts);
    this.$el = $(el).is('form') ? $(el) : $(el).find('form');
    if (!this.options.container) {
      console.log("Please provide a container");
      return;
    }
    this.$container = $(this.options.container);
    this.render();
    this.attachHandlers();
  }

  Card.prototype.render = function() {
    var baseWidth, ua;
    this.$container.append(this.template);
    $.each(this.options.cardSelectors, (function(_this) {
      return function(name, selector) {
        return _this["$" + name] = _this.$container.find(selector);
      };
    })(this));
    $.each(this.options.formSelectors, (function(_this) {
      return function(name, selector) {
        return _this["$" + name] = _this.options[name] || _this.$el.find(selector);
      };
    })(this));
    if (this.options.formatting) {
      this.$numberInput.payment('formatCardNumber');
      this.$expiryInput.payment('formatCardExpiry');
      this.$cvcInput.payment('formatCardCVC');
    }
    if (this.options.width) {
      baseWidth = parseInt(this.$cardContainer.css('width'));
      this.$cardContainer.css("transform", "scale(" + (this.options.width / baseWidth) + ")");
    }
    if (typeof navigator !== "undefined" && navigator !== null ? navigator.userAgent : void 0) {
      ua = navigator.userAgent.toLowerCase();
      if (ua.indexOf('safari') !== -1 && ua.indexOf('chrome') === -1) {
        return this.$card.addClass('no-radial-gradient');
      }
    }
  };

  Card.prototype.attachHandlers = function() {
    this.$numberInput.bindVal(this.$numberDisplay, {
      fill: false,
      filters: validToggler('validateCardNumber')
    }).on('payment.cardType', this.handle('setCardType'));
    this.$expiryInput.bindVal(this.$expiryDisplay, {
      filters: [
        function(val) {
          return val.replace(/(\s+)/g, '');
        }, validToggler('validateCardExpiry')
      ]
    }).on('keydown', this.handle('captureTab'));
    this.$cvcInput.bindVal(this.$cvcDisplay, validToggler('validateCardCVC')).on('focus', this.handle('flipCard')).on('blur', this.handle('flipCard'));
    return this.$nameInput.bindVal(this.$nameDisplay, {
      fill: false
    });
  };

  Card.prototype.handle = function(fn) {
    return (function(_this) {
      return function(e) {
        var $el, args;
        $el = $(e.currentTarget);
        args = Array.prototype.slice.call(arguments);
        args.unshift($el);
        return _this.handlers[fn].apply(_this, args);
      };
    })(this);
  };

  Card.prototype.handlers = {
    setCardType: function($el, e, cardType) {
      if (!this.$card.hasClass(cardType)) {
        this.$card.removeClass('unknown');
        this.$card.removeClass(this.cardTypes.join(' '));
        this.$card.addClass(cardType);
        return this.$card.toggleClass('identified', cardType !== 'unknown');
      }
    },
    flipCard: function($el, e) {
      return this.$card.toggleClass('flipped');
    },
    captureTab: function($el, e) {
      var keyCode, val;
      keyCode = e.keyCode || e.which;
      if (keyCode !== 9 || e.shiftKey) {
        return;
      }
      val = $el.payment('cardExpiryVal');
      if (!(val.month || val.year)) {
        return;
      }
      if (!$.payment.validateCardExpiry(val.month, val.year)) {
        return e.preventDefault();
      }
    }
  };

  $.fn.bindVal = function(out, opts) {
    var $el, i, o, outDefaults;
    if (opts == null) {
      opts = {};
    }
    opts.fill = opts.fill || false;
    opts.filters = opts.filters || [];
    if (!(opts.filters instanceof Array)) {
      opts.filters = [opts.filters];
    }
    $el = $(this);
    outDefaults = (function() {
      var _i, _len, _results;
      _results = [];
      for (i = _i = 0, _len = out.length; _i < _len; i = ++_i) {
        o = out[i];
        _results.push(out.eq(i).text());
      }
      return _results;
    })();
    $el.on('focus', function() {
      return out.addClass('focused');
    });
    $el.on('blur', function() {
      return out.removeClass('focused');
    });
    $el.on('keyup', function(e) {
      var filter, outVal, val, _i, _j, _len, _len1, _ref, _results;
      val = $el.val();
      _ref = opts.filters;
      for (_i = 0, _len = _ref.length; _i < _len; _i++) {
        filter = _ref[_i];
        val = filter(val, $el, out);
      }
      _results = [];
      for (i = _j = 0, _len1 = out.length; _j < _len1; i = ++_j) {
        o = out[i];
        if (opts.fill) {
          outVal = val + outDefaults[i].substring(val.length);
        } else {
          outVal = val || outDefaults[i];
        }
        _results.push(out.eq(i).text(outVal));
      }
      return _results;
    });
    return $el;
  };

  validToggler = function(validatorName) {
    return function(val, $in, $out) {
      $out.toggleClass('valid', $.payment[validatorName](val));
      return val;
    };
  };

  return Card;

})();

$.fn.extend({
  card: function() {
    var args, option;
    option = arguments[0], args = 2 <= arguments.length ? __slice.call(arguments, 1) : [];
    return this.each(function() {
      var $this, data;
      $this = $(this);
      data = $this.data('card');
      if (!data) {
        $this.data('card', (data = new Card(this, option)));
      }
      if (typeof option === 'string') {
        return data[option].apply(data, args);
      }
    });
  }
});


},{"jquery.payment":1}]},{},[2])
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlcyI6WyIvVXNlcnMvZXZhbi9Db2RpbmcvZm9ya3MvY2FyZC9ub2RlX21vZHVsZXMvZ3VscC1icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCIvVXNlcnMvZXZhbi9Db2RpbmcvZm9ya3MvY2FyZC9ub2RlX21vZHVsZXMvanF1ZXJ5LnBheW1lbnQvbGliL2pxdWVyeS5wYXltZW50LmpzIiwiL1VzZXJzL2V2YW4vQ29kaW5nL2ZvcmtzL2NhcmQvc3JjL2NvZmZlZS9jYXJkLmNvZmZlZSJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7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QUFBLE1BQUEsS0FBaUIsUUFBcEI7ZUFDRSxJQUFLLENBQUEsTUFBQSxDQUFPLENBQUMsS0FBYixDQUFtQixJQUFuQixFQUF5QixJQUF6QixFQURGO09BTkk7SUFBQSxDQUFOLEVBRGdCO0VBQUEsQ0FBTjtDQUFaLENBN0xBLENBQUEiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3Rocm93IG5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIil9dmFyIGY9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGYuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sZixmLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIi8vIEdlbmVyYXRlZCBieSBDb2ZmZWVTY3JpcHQgMS43LjFcbihmdW5jdGlvbigpIHtcbiAgdmFyICQsIGNhcmRGcm9tTnVtYmVyLCBjYXJkRnJvbVR5cGUsIGNhcmRzLCBkZWZhdWx0Rm9ybWF0LCBmb3JtYXRCYWNrQ2FyZE51bWJlciwgZm9ybWF0QmFja0V4cGlyeSwgZm9ybWF0Q2FyZE51bWJlciwgZm9ybWF0RXhwaXJ5LCBmb3JtYXRGb3J3YXJkRXhwaXJ5LCBmb3JtYXRGb3J3YXJkU2xhc2gsIGhhc1RleHRTZWxlY3RlZCwgbHVobkNoZWNrLCByZUZvcm1hdENhcmROdW1iZXIsIHJlc3RyaWN0Q1ZDLCByZXN0cmljdENhcmROdW1iZXIsIHJlc3RyaWN0RXhwaXJ5LCByZXN0cmljdE51bWVyaWMsIHNldENhcmRUeXBlLFxuICAgIF9fc2xpY2UgPSBbXS5zbGljZSxcbiAgICBfX2luZGV4T2YgPSBbXS5pbmRleE9mIHx8IGZ1bmN0aW9uKGl0ZW0pIHsgZm9yICh2YXIgaSA9IDAsIGwgPSB0aGlzLmxlbmd0aDsgaSA8IGw7IGkrKykgeyBpZiAoaSBpbiB0aGlzICYmIHRoaXNbaV0gPT09IGl0ZW0pIHJldHVybiBpOyB9IHJldHVybiAtMTsgfTtcblxuICAkID0galF1ZXJ5O1xuXG4gICQucGF5bWVudCA9IHt9O1xuXG4gICQucGF5bWVudC5mbiA9IHt9O1xuXG4gICQuZm4ucGF5bWVudCA9IGZ1bmN0aW9uKCkge1xuICAgIHZhciBhcmdzLCBtZXRob2Q7XG4gICAgbWV0aG9kID0gYXJndW1lbnRzWzBdLCBhcmdzID0gMiA8PSBhcmd1bWVudHMubGVuZ3RoID8gX19zbGljZS5jYWxsKGFyZ3VtZW50cywgMSkgOiBbXTtcbiAgICByZXR1cm4gJC5wYXltZW50LmZuW21ldGhvZF0uYXBwbHkodGhpcywgYXJncyk7XG4gIH07XG5cbiAgZGVmYXVsdEZvcm1hdCA9IC8oXFxkezEsNH0pL2c7XG5cbiAgY2FyZHMgPSBbXG4gICAge1xuICAgICAgdHlwZTogJ21hZXN0cm8nLFxuICAgICAgcGF0dGVybjogL14oNTAxOHw1MDIwfDUwMzh8NjMwNHw2NzU5fDY3NlsxLTNdKS8sXG4gICAgICBmb3JtYXQ6IGRlZmF1bHRGb3JtYXQsXG4gICAgICBsZW5ndGg6IFsxMiwgMTMsIDE0LCAxNSwgMTYsIDE3LCAxOCwgMTldLFxuICAgICAgY3ZjTGVuZ3RoOiBbM10sXG4gICAgICBsdWhuOiB0cnVlXG4gICAgfSwge1xuICAgICAgdHlwZTogJ2RpbmVyc2NsdWInLFxuICAgICAgcGF0dGVybjogL14oMzZ8Mzh8MzBbMC01XSkvLFxuICAgICAgZm9ybWF0OiBkZWZhdWx0Rm9ybWF0LFxuICAgICAgbGVuZ3RoOiBbMTRdLFxuICAgICAgY3ZjTGVuZ3RoOiBbM10sXG4gICAgICBsdWhuOiB0cnVlXG4gICAgfSwge1xuICAgICAgdHlwZTogJ2xhc2VyJyxcbiAgICAgIHBhdHRlcm46IC9eKDY3MDZ8Njc3MXw2NzA5KS8sXG4gICAgICBmb3JtYXQ6IGRlZmF1bHRGb3JtYXQsXG4gICAgICBsZW5ndGg6IFsxNiwgMTcsIDE4LCAxOV0sXG4gICAgICBjdmNMZW5ndGg6IFszXSxcbiAgICAgIGx1aG46IHRydWVcbiAgICB9LCB7XG4gICAgICB0eXBlOiAnamNiJyxcbiAgICAgIHBhdHRlcm46IC9eMzUvLFxuICAgICAgZm9ybWF0OiBkZWZhdWx0Rm9ybWF0LFxuICAgICAgbGVuZ3RoOiBbMTZdLFxuICAgICAgY3ZjTGVuZ3RoOiBbM10sXG4gICAgICBsdWhuOiB0cnVlXG4gICAgfSwge1xuICAgICAgdHlwZTogJ3VuaW9ucGF5JyxcbiAgICAgIHBhdHRlcm46IC9eNjIvLFxuICAgICAgZm9ybWF0OiBkZWZhdWx0Rm9ybWF0LFxuICAgICAgbGVuZ3RoOiBbMTYsIDE3LCAxOCwgMTldLFxuICAgICAgY3ZjTGVuZ3RoOiBbM10sXG4gICAgICBsdWhuOiBmYWxzZVxuICAgIH0sIHtcbiAgICAgIHR5cGU6ICdkaXNjb3ZlcicsXG4gICAgICBwYXR0ZXJuOiAvXig2MDExfDY1fDY0WzQtOV18NjIyKS8sXG4gICAgICBmb3JtYXQ6IGRlZmF1bHRGb3JtYXQsXG4gICAgICBsZW5ndGg6IFsxNl0sXG4gICAgICBjdmNMZW5ndGg6IFszXSxcbiAgICAgIGx1aG46IHRydWVcbiAgICB9LCB7XG4gICAgICB0eXBlOiAnbWFzdGVyY2FyZCcsXG4gICAgICBwYXR0ZXJuOiAvXjVbMS01XS8sXG4gICAgICBmb3JtYXQ6IGRlZmF1bHRGb3JtYXQsXG4gICAgICBsZW5ndGg6IFsxNl0sXG4gICAgICBjdmNMZW5ndGg6IFszXSxcbiAgICAgIGx1aG46IHRydWVcbiAgICB9LCB7XG4gICAgICB0eXBlOiAnYW1leCcsXG4gICAgICBwYXR0ZXJuOiAvXjNbNDddLyxcbiAgICAgIGZvcm1hdDogLyhcXGR7MSw0fSkoXFxkezEsNn0pPyhcXGR7MSw1fSk/LyxcbiAgICAgIGxlbmd0aDogWzE1XSxcbiAgICAgIGN2Y0xlbmd0aDogWzMsIDRdLFxuICAgICAgbHVobjogdHJ1ZVxuICAgIH0sIHtcbiAgICAgIHR5cGU6ICd2aXNhJyxcbiAgICAgIHBhdHRlcm46IC9eNC8sXG4gICAgICBmb3JtYXQ6IGRlZmF1bHRGb3JtYXQsXG4gICAgICBsZW5ndGg6IFsxMywgMTZdLFxuICAgICAgY3ZjTGVuZ3RoOiBbM10sXG4gICAgICBsdWhuOiB0cnVlXG4gICAgfVxuICBdO1xuXG4gIGNhcmRGcm9tTnVtYmVyID0gZnVuY3Rpb24obnVtKSB7XG4gICAgdmFyIGNhcmQsIF9pLCBfbGVuO1xuICAgIG51bSA9IChudW0gKyAnJykucmVwbGFjZSgvXFxEL2csICcnKTtcbiAgICBmb3IgKF9pID0gMCwgX2xlbiA9IGNhcmRzLmxlbmd0aDsgX2kgPCBfbGVuOyBfaSsrKSB7XG4gICAgICBjYXJkID0gY2FyZHNbX2ldO1xuICAgICAgaWYgKGNhcmQucGF0dGVybi50ZXN0KG51bSkpIHtcbiAgICAgICAgcmV0dXJuIGNhcmQ7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIGNhcmRGcm9tVHlwZSA9IGZ1bmN0aW9uKHR5cGUpIHtcbiAgICB2YXIgY2FyZCwgX2ksIF9sZW47XG4gICAgZm9yIChfaSA9IDAsIF9sZW4gPSBjYXJkcy5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykge1xuICAgICAgY2FyZCA9IGNhcmRzW19pXTtcbiAgICAgIGlmIChjYXJkLnR5cGUgPT09IHR5cGUpIHtcbiAgICAgICAgcmV0dXJuIGNhcmQ7XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIGx1aG5DaGVjayA9IGZ1bmN0aW9uKG51bSkge1xuICAgIHZhciBkaWdpdCwgZGlnaXRzLCBvZGQsIHN1bSwgX2ksIF9sZW47XG4gICAgb2RkID0gdHJ1ZTtcbiAgICBzdW0gPSAwO1xuICAgIGRpZ2l0cyA9IChudW0gKyAnJykuc3BsaXQoJycpLnJldmVyc2UoKTtcbiAgICBmb3IgKF9pID0gMCwgX2xlbiA9IGRpZ2l0cy5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykge1xuICAgICAgZGlnaXQgPSBkaWdpdHNbX2ldO1xuICAgICAgZGlnaXQgPSBwYXJzZUludChkaWdpdCwgMTApO1xuICAgICAgaWYgKChvZGQgPSAhb2RkKSkge1xuICAgICAgICBkaWdpdCAqPSAyO1xuICAgICAgfVxuICAgICAgaWYgKGRpZ2l0ID4gOSkge1xuICAgICAgICBkaWdpdCAtPSA5O1xuICAgICAgfVxuICAgICAgc3VtICs9IGRpZ2l0O1xuICAgIH1cbiAgICByZXR1cm4gc3VtICUgMTAgPT09IDA7XG4gIH07XG5cbiAgaGFzVGV4dFNlbGVjdGVkID0gZnVuY3Rpb24oJHRhcmdldCkge1xuICAgIHZhciBfcmVmO1xuICAgIGlmICgoJHRhcmdldC5wcm9wKCdzZWxlY3Rpb25TdGFydCcpICE9IG51bGwpICYmICR0YXJnZXQucHJvcCgnc2VsZWN0aW9uU3RhcnQnKSAhPT0gJHRhcmdldC5wcm9wKCdzZWxlY3Rpb25FbmQnKSkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIGlmICh0eXBlb2YgZG9jdW1lbnQgIT09IFwidW5kZWZpbmVkXCIgJiYgZG9jdW1lbnQgIT09IG51bGwgPyAoX3JlZiA9IGRvY3VtZW50LnNlbGVjdGlvbikgIT0gbnVsbCA/IHR5cGVvZiBfcmVmLmNyZWF0ZVJhbmdlID09PSBcImZ1bmN0aW9uXCIgPyBfcmVmLmNyZWF0ZVJhbmdlKCkudGV4dCA6IHZvaWQgMCA6IHZvaWQgMCA6IHZvaWQgMCkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbiAgfTtcblxuICByZUZvcm1hdENhcmROdW1iZXIgPSBmdW5jdGlvbihlKSB7XG4gICAgcmV0dXJuIHNldFRpbWVvdXQoKGZ1bmN0aW9uKF90aGlzKSB7XG4gICAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciAkdGFyZ2V0LCB2YWx1ZTtcbiAgICAgICAgJHRhcmdldCA9ICQoZS5jdXJyZW50VGFyZ2V0KTtcbiAgICAgICAgdmFsdWUgPSAkdGFyZ2V0LnZhbCgpO1xuICAgICAgICB2YWx1ZSA9ICQucGF5bWVudC5mb3JtYXRDYXJkTnVtYmVyKHZhbHVlKTtcbiAgICAgICAgcmV0dXJuICR0YXJnZXQudmFsKHZhbHVlKTtcbiAgICAgIH07XG4gICAgfSkodGhpcykpO1xuICB9O1xuXG4gIGZvcm1hdENhcmROdW1iZXIgPSBmdW5jdGlvbihlKSB7XG4gICAgdmFyICR0YXJnZXQsIGNhcmQsIGRpZ2l0LCBsZW5ndGgsIHJlLCB1cHBlckxlbmd0aCwgdmFsdWU7XG4gICAgZGlnaXQgPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGUud2hpY2gpO1xuICAgIGlmICghL15cXGQrJC8udGVzdChkaWdpdCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgJHRhcmdldCA9ICQoZS5jdXJyZW50VGFyZ2V0KTtcbiAgICB2YWx1ZSA9ICR0YXJnZXQudmFsKCk7XG4gICAgY2FyZCA9IGNhcmRGcm9tTnVtYmVyKHZhbHVlICsgZGlnaXQpO1xuICAgIGxlbmd0aCA9ICh2YWx1ZS5yZXBsYWNlKC9cXEQvZywgJycpICsgZGlnaXQpLmxlbmd0aDtcbiAgICB1cHBlckxlbmd0aCA9IDE2O1xuICAgIGlmIChjYXJkKSB7XG4gICAgICB1cHBlckxlbmd0aCA9IGNhcmQubGVuZ3RoW2NhcmQubGVuZ3RoLmxlbmd0aCAtIDFdO1xuICAgIH1cbiAgICBpZiAobGVuZ3RoID49IHVwcGVyTGVuZ3RoKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmICgoJHRhcmdldC5wcm9wKCdzZWxlY3Rpb25TdGFydCcpICE9IG51bGwpICYmICR0YXJnZXQucHJvcCgnc2VsZWN0aW9uU3RhcnQnKSAhPT0gdmFsdWUubGVuZ3RoKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChjYXJkICYmIGNhcmQudHlwZSA9PT0gJ2FtZXgnKSB7XG4gICAgICByZSA9IC9eKFxcZHs0fXxcXGR7NH1cXHNcXGR7Nn0pJC87XG4gICAgfSBlbHNlIHtcbiAgICAgIHJlID0gLyg/Ol58XFxzKShcXGR7NH0pJC87XG4gICAgfVxuICAgIGlmIChyZS50ZXN0KHZhbHVlKSkge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgcmV0dXJuICR0YXJnZXQudmFsKHZhbHVlICsgJyAnICsgZGlnaXQpO1xuICAgIH0gZWxzZSBpZiAocmUudGVzdCh2YWx1ZSArIGRpZ2l0KSkge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgcmV0dXJuICR0YXJnZXQudmFsKHZhbHVlICsgZGlnaXQgKyAnICcpO1xuICAgIH1cbiAgfTtcblxuICBmb3JtYXRCYWNrQ2FyZE51bWJlciA9IGZ1bmN0aW9uKGUpIHtcbiAgICB2YXIgJHRhcmdldCwgdmFsdWU7XG4gICAgJHRhcmdldCA9ICQoZS5jdXJyZW50VGFyZ2V0KTtcbiAgICB2YWx1ZSA9ICR0YXJnZXQudmFsKCk7XG4gICAgaWYgKGUubWV0YSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoZS53aGljaCAhPT0gOCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoKCR0YXJnZXQucHJvcCgnc2VsZWN0aW9uU3RhcnQnKSAhPSBudWxsKSAmJiAkdGFyZ2V0LnByb3AoJ3NlbGVjdGlvblN0YXJ0JykgIT09IHZhbHVlLmxlbmd0aCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoL1xcZFxccyQvLnRlc3QodmFsdWUpKSB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICByZXR1cm4gJHRhcmdldC52YWwodmFsdWUucmVwbGFjZSgvXFxkXFxzJC8sICcnKSk7XG4gICAgfSBlbHNlIGlmICgvXFxzXFxkPyQvLnRlc3QodmFsdWUpKSB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICByZXR1cm4gJHRhcmdldC52YWwodmFsdWUucmVwbGFjZSgvXFxzXFxkPyQvLCAnJykpO1xuICAgIH1cbiAgfTtcblxuICBmb3JtYXRFeHBpcnkgPSBmdW5jdGlvbihlKSB7XG4gICAgdmFyICR0YXJnZXQsIGRpZ2l0LCB2YWw7XG4gICAgZGlnaXQgPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGUud2hpY2gpO1xuICAgIGlmICghL15cXGQrJC8udGVzdChkaWdpdCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgJHRhcmdldCA9ICQoZS5jdXJyZW50VGFyZ2V0KTtcbiAgICB2YWwgPSAkdGFyZ2V0LnZhbCgpICsgZGlnaXQ7XG4gICAgaWYgKC9eXFxkJC8udGVzdCh2YWwpICYmICh2YWwgIT09ICcwJyAmJiB2YWwgIT09ICcxJykpIHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHJldHVybiAkdGFyZ2V0LnZhbChcIjBcIiArIHZhbCArIFwiIC8gXCIpO1xuICAgIH0gZWxzZSBpZiAoL15cXGRcXGQkLy50ZXN0KHZhbCkpIHtcbiAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgIHJldHVybiAkdGFyZ2V0LnZhbChcIlwiICsgdmFsICsgXCIgLyBcIik7XG4gICAgfVxuICB9O1xuXG4gIGZvcm1hdEZvcndhcmRFeHBpcnkgPSBmdW5jdGlvbihlKSB7XG4gICAgdmFyICR0YXJnZXQsIGRpZ2l0LCB2YWw7XG4gICAgZGlnaXQgPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGUud2hpY2gpO1xuICAgIGlmICghL15cXGQrJC8udGVzdChkaWdpdCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgJHRhcmdldCA9ICQoZS5jdXJyZW50VGFyZ2V0KTtcbiAgICB2YWwgPSAkdGFyZ2V0LnZhbCgpO1xuICAgIGlmICgvXlxcZFxcZCQvLnRlc3QodmFsKSkge1xuICAgICAgcmV0dXJuICR0YXJnZXQudmFsKFwiXCIgKyB2YWwgKyBcIiAvIFwiKTtcbiAgICB9XG4gIH07XG5cbiAgZm9ybWF0Rm9yd2FyZFNsYXNoID0gZnVuY3Rpb24oZSkge1xuICAgIHZhciAkdGFyZ2V0LCBzbGFzaCwgdmFsO1xuICAgIHNsYXNoID0gU3RyaW5nLmZyb21DaGFyQ29kZShlLndoaWNoKTtcbiAgICBpZiAoc2xhc2ggIT09ICcvJykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICAkdGFyZ2V0ID0gJChlLmN1cnJlbnRUYXJnZXQpO1xuICAgIHZhbCA9ICR0YXJnZXQudmFsKCk7XG4gICAgaWYgKC9eXFxkJC8udGVzdCh2YWwpICYmIHZhbCAhPT0gJzAnKSB7XG4gICAgICByZXR1cm4gJHRhcmdldC52YWwoXCIwXCIgKyB2YWwgKyBcIiAvIFwiKTtcbiAgICB9XG4gIH07XG5cbiAgZm9ybWF0QmFja0V4cGlyeSA9IGZ1bmN0aW9uKGUpIHtcbiAgICB2YXIgJHRhcmdldCwgdmFsdWU7XG4gICAgaWYgKGUubWV0YSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICAkdGFyZ2V0ID0gJChlLmN1cnJlbnRUYXJnZXQpO1xuICAgIHZhbHVlID0gJHRhcmdldC52YWwoKTtcbiAgICBpZiAoZS53aGljaCAhPT0gOCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoKCR0YXJnZXQucHJvcCgnc2VsZWN0aW9uU3RhcnQnKSAhPSBudWxsKSAmJiAkdGFyZ2V0LnByb3AoJ3NlbGVjdGlvblN0YXJ0JykgIT09IHZhbHVlLmxlbmd0aCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoL1xcZChcXHN8XFwvKSskLy50ZXN0KHZhbHVlKSkge1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgcmV0dXJuICR0YXJnZXQudmFsKHZhbHVlLnJlcGxhY2UoL1xcZChcXHN8XFwvKSokLywgJycpKTtcbiAgICB9IGVsc2UgaWYgKC9cXHNcXC9cXHM/XFxkPyQvLnRlc3QodmFsdWUpKSB7XG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICByZXR1cm4gJHRhcmdldC52YWwodmFsdWUucmVwbGFjZSgvXFxzXFwvXFxzP1xcZD8kLywgJycpKTtcbiAgICB9XG4gIH07XG5cbiAgcmVzdHJpY3ROdW1lcmljID0gZnVuY3Rpb24oZSkge1xuICAgIHZhciBpbnB1dDtcbiAgICBpZiAoZS5tZXRhS2V5IHx8IGUuY3RybEtleSkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIGlmIChlLndoaWNoID09PSAzMikge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBpZiAoZS53aGljaCA9PT0gMCkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIGlmIChlLndoaWNoIDwgMzMpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICBpbnB1dCA9IFN0cmluZy5mcm9tQ2hhckNvZGUoZS53aGljaCk7XG4gICAgcmV0dXJuICEhL1tcXGRcXHNdLy50ZXN0KGlucHV0KTtcbiAgfTtcblxuICByZXN0cmljdENhcmROdW1iZXIgPSBmdW5jdGlvbihlKSB7XG4gICAgdmFyICR0YXJnZXQsIGNhcmQsIGRpZ2l0LCB2YWx1ZTtcbiAgICAkdGFyZ2V0ID0gJChlLmN1cnJlbnRUYXJnZXQpO1xuICAgIGRpZ2l0ID0gU3RyaW5nLmZyb21DaGFyQ29kZShlLndoaWNoKTtcbiAgICBpZiAoIS9eXFxkKyQvLnRlc3QoZGlnaXQpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChoYXNUZXh0U2VsZWN0ZWQoJHRhcmdldCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFsdWUgPSAoJHRhcmdldC52YWwoKSArIGRpZ2l0KS5yZXBsYWNlKC9cXEQvZywgJycpO1xuICAgIGNhcmQgPSBjYXJkRnJvbU51bWJlcih2YWx1ZSk7XG4gICAgaWYgKGNhcmQpIHtcbiAgICAgIHJldHVybiB2YWx1ZS5sZW5ndGggPD0gY2FyZC5sZW5ndGhbY2FyZC5sZW5ndGgubGVuZ3RoIC0gMV07XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB2YWx1ZS5sZW5ndGggPD0gMTY7XG4gICAgfVxuICB9O1xuXG4gIHJlc3RyaWN0RXhwaXJ5ID0gZnVuY3Rpb24oZSkge1xuICAgIHZhciAkdGFyZ2V0LCBkaWdpdCwgdmFsdWU7XG4gICAgJHRhcmdldCA9ICQoZS5jdXJyZW50VGFyZ2V0KTtcbiAgICBkaWdpdCA9IFN0cmluZy5mcm9tQ2hhckNvZGUoZS53aGljaCk7XG4gICAgaWYgKCEvXlxcZCskLy50ZXN0KGRpZ2l0KSkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBpZiAoaGFzVGV4dFNlbGVjdGVkKCR0YXJnZXQpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhbHVlID0gJHRhcmdldC52YWwoKSArIGRpZ2l0O1xuICAgIHZhbHVlID0gdmFsdWUucmVwbGFjZSgvXFxEL2csICcnKTtcbiAgICBpZiAodmFsdWUubGVuZ3RoID4gNikge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfTtcblxuICByZXN0cmljdENWQyA9IGZ1bmN0aW9uKGUpIHtcbiAgICB2YXIgJHRhcmdldCwgZGlnaXQsIHZhbDtcbiAgICAkdGFyZ2V0ID0gJChlLmN1cnJlbnRUYXJnZXQpO1xuICAgIGRpZ2l0ID0gU3RyaW5nLmZyb21DaGFyQ29kZShlLndoaWNoKTtcbiAgICBpZiAoIS9eXFxkKyQvLnRlc3QoZGlnaXQpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIGlmIChoYXNUZXh0U2VsZWN0ZWQoJHRhcmdldCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFsID0gJHRhcmdldC52YWwoKSArIGRpZ2l0O1xuICAgIHJldHVybiB2YWwubGVuZ3RoIDw9IDQ7XG4gIH07XG5cbiAgc2V0Q2FyZFR5cGUgPSBmdW5jdGlvbihlKSB7XG4gICAgdmFyICR0YXJnZXQsIGFsbFR5cGVzLCBjYXJkLCBjYXJkVHlwZSwgdmFsO1xuICAgICR0YXJnZXQgPSAkKGUuY3VycmVudFRhcmdldCk7XG4gICAgdmFsID0gJHRhcmdldC52YWwoKTtcbiAgICBjYXJkVHlwZSA9ICQucGF5bWVudC5jYXJkVHlwZSh2YWwpIHx8ICd1bmtub3duJztcbiAgICBpZiAoISR0YXJnZXQuaGFzQ2xhc3MoY2FyZFR5cGUpKSB7XG4gICAgICBhbGxUeXBlcyA9IChmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIF9pLCBfbGVuLCBfcmVzdWx0cztcbiAgICAgICAgX3Jlc3VsdHMgPSBbXTtcbiAgICAgICAgZm9yIChfaSA9IDAsIF9sZW4gPSBjYXJkcy5sZW5ndGg7IF9pIDwgX2xlbjsgX2krKykge1xuICAgICAgICAgIGNhcmQgPSBjYXJkc1tfaV07XG4gICAgICAgICAgX3Jlc3VsdHMucHVzaChjYXJkLnR5cGUpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBfcmVzdWx0cztcbiAgICAgIH0pKCk7XG4gICAgICAkdGFyZ2V0LnJlbW92ZUNsYXNzKCd1bmtub3duJyk7XG4gICAgICAkdGFyZ2V0LnJlbW92ZUNsYXNzKGFsbFR5cGVzLmpvaW4oJyAnKSk7XG4gICAgICAkdGFyZ2V0LmFkZENsYXNzKGNhcmRUeXBlKTtcbiAgICAgICR0YXJnZXQudG9nZ2xlQ2xhc3MoJ2lkZW50aWZpZWQnLCBjYXJkVHlwZSAhPT0gJ3Vua25vd24nKTtcbiAgICAgIHJldHVybiAkdGFyZ2V0LnRyaWdnZXIoJ3BheW1lbnQuY2FyZFR5cGUnLCBjYXJkVHlwZSk7XG4gICAgfVxuICB9O1xuXG4gICQucGF5bWVudC5mbi5mb3JtYXRDYXJkQ1ZDID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5wYXltZW50KCdyZXN0cmljdE51bWVyaWMnKTtcbiAgICB0aGlzLm9uKCdrZXlwcmVzcycsIHJlc3RyaWN0Q1ZDKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICAkLnBheW1lbnQuZm4uZm9ybWF0Q2FyZEV4cGlyeSA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMucGF5bWVudCgncmVzdHJpY3ROdW1lcmljJyk7XG4gICAgdGhpcy5vbigna2V5cHJlc3MnLCByZXN0cmljdEV4cGlyeSk7XG4gICAgdGhpcy5vbigna2V5cHJlc3MnLCBmb3JtYXRFeHBpcnkpO1xuICAgIHRoaXMub24oJ2tleXByZXNzJywgZm9ybWF0Rm9yd2FyZFNsYXNoKTtcbiAgICB0aGlzLm9uKCdrZXlwcmVzcycsIGZvcm1hdEZvcndhcmRFeHBpcnkpO1xuICAgIHRoaXMub24oJ2tleWRvd24nLCBmb3JtYXRCYWNrRXhwaXJ5KTtcbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICAkLnBheW1lbnQuZm4uZm9ybWF0Q2FyZE51bWJlciA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMucGF5bWVudCgncmVzdHJpY3ROdW1lcmljJyk7XG4gICAgdGhpcy5vbigna2V5cHJlc3MnLCByZXN0cmljdENhcmROdW1iZXIpO1xuICAgIHRoaXMub24oJ2tleXByZXNzJywgZm9ybWF0Q2FyZE51bWJlcik7XG4gICAgdGhpcy5vbigna2V5ZG93bicsIGZvcm1hdEJhY2tDYXJkTnVtYmVyKTtcbiAgICB0aGlzLm9uKCdrZXl1cCcsIHNldENhcmRUeXBlKTtcbiAgICB0aGlzLm9uKCdwYXN0ZScsIHJlRm9ybWF0Q2FyZE51bWJlcik7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH07XG5cbiAgJC5wYXltZW50LmZuLnJlc3RyaWN0TnVtZXJpYyA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMub24oJ2tleXByZXNzJywgcmVzdHJpY3ROdW1lcmljKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfTtcblxuICAkLnBheW1lbnQuZm4uY2FyZEV4cGlyeVZhbCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiAkLnBheW1lbnQuY2FyZEV4cGlyeVZhbCgkKHRoaXMpLnZhbCgpKTtcbiAgfTtcblxuICAkLnBheW1lbnQuY2FyZEV4cGlyeVZhbCA9IGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgdmFyIG1vbnRoLCBwcmVmaXgsIHllYXIsIF9yZWY7XG4gICAgdmFsdWUgPSB2YWx1ZS5yZXBsYWNlKC9cXHMvZywgJycpO1xuICAgIF9yZWYgPSB2YWx1ZS5zcGxpdCgnLycsIDIpLCBtb250aCA9IF9yZWZbMF0sIHllYXIgPSBfcmVmWzFdO1xuICAgIGlmICgoeWVhciAhPSBudWxsID8geWVhci5sZW5ndGggOiB2b2lkIDApID09PSAyICYmIC9eXFxkKyQvLnRlc3QoeWVhcikpIHtcbiAgICAgIHByZWZpeCA9IChuZXcgRGF0ZSkuZ2V0RnVsbFllYXIoKTtcbiAgICAgIHByZWZpeCA9IHByZWZpeC50b1N0cmluZygpLnNsaWNlKDAsIDIpO1xuICAgICAgeWVhciA9IHByZWZpeCArIHllYXI7XG4gICAgfVxuICAgIG1vbnRoID0gcGFyc2VJbnQobW9udGgsIDEwKTtcbiAgICB5ZWFyID0gcGFyc2VJbnQoeWVhciwgMTApO1xuICAgIHJldHVybiB7XG4gICAgICBtb250aDogbW9udGgsXG4gICAgICB5ZWFyOiB5ZWFyXG4gICAgfTtcbiAgfTtcblxuICAkLnBheW1lbnQudmFsaWRhdGVDYXJkTnVtYmVyID0gZnVuY3Rpb24obnVtKSB7XG4gICAgdmFyIGNhcmQsIF9yZWY7XG4gICAgbnVtID0gKG51bSArICcnKS5yZXBsYWNlKC9cXHMrfC0vZywgJycpO1xuICAgIGlmICghL15cXGQrJC8udGVzdChudW0pKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGNhcmQgPSBjYXJkRnJvbU51bWJlcihudW0pO1xuICAgIGlmICghY2FyZCkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICByZXR1cm4gKF9yZWYgPSBudW0ubGVuZ3RoLCBfX2luZGV4T2YuY2FsbChjYXJkLmxlbmd0aCwgX3JlZikgPj0gMCkgJiYgKGNhcmQubHVobiA9PT0gZmFsc2UgfHwgbHVobkNoZWNrKG51bSkpO1xuICB9O1xuXG4gICQucGF5bWVudC52YWxpZGF0ZUNhcmRFeHBpcnkgPSAoZnVuY3Rpb24oX3RoaXMpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24obW9udGgsIHllYXIpIHtcbiAgICAgIHZhciBjdXJyZW50VGltZSwgZXhwaXJ5LCBwcmVmaXgsIF9yZWY7XG4gICAgICBpZiAodHlwZW9mIG1vbnRoID09PSAnb2JqZWN0JyAmJiAnbW9udGgnIGluIG1vbnRoKSB7XG4gICAgICAgIF9yZWYgPSBtb250aCwgbW9udGggPSBfcmVmLm1vbnRoLCB5ZWFyID0gX3JlZi55ZWFyO1xuICAgICAgfVxuICAgICAgaWYgKCEobW9udGggJiYgeWVhcikpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgbW9udGggPSAkLnRyaW0obW9udGgpO1xuICAgICAgeWVhciA9ICQudHJpbSh5ZWFyKTtcbiAgICAgIGlmICghL15cXGQrJC8udGVzdChtb250aCkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgaWYgKCEvXlxcZCskLy50ZXN0KHllYXIpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIGlmICghKHBhcnNlSW50KG1vbnRoLCAxMCkgPD0gMTIpKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIGlmICh5ZWFyLmxlbmd0aCA9PT0gMikge1xuICAgICAgICBwcmVmaXggPSAobmV3IERhdGUpLmdldEZ1bGxZZWFyKCk7XG4gICAgICAgIHByZWZpeCA9IHByZWZpeC50b1N0cmluZygpLnNsaWNlKDAsIDIpO1xuICAgICAgICB5ZWFyID0gcHJlZml4ICsgeWVhcjtcbiAgICAgIH1cbiAgICAgIGV4cGlyeSA9IG5ldyBEYXRlKHllYXIsIG1vbnRoKTtcbiAgICAgIGN1cnJlbnRUaW1lID0gbmV3IERhdGU7XG4gICAgICBleHBpcnkuc2V0TW9udGgoZXhwaXJ5LmdldE1vbnRoKCkgLSAxKTtcbiAgICAgIGV4cGlyeS5zZXRNb250aChleHBpcnkuZ2V0TW9udGgoKSArIDEsIDEpO1xuICAgICAgcmV0dXJuIGV4cGlyeSA+IGN1cnJlbnRUaW1lO1xuICAgIH07XG4gIH0pKHRoaXMpO1xuXG4gICQucGF5bWVudC52YWxpZGF0ZUNhcmRDVkMgPSBmdW5jdGlvbihjdmMsIHR5cGUpIHtcbiAgICB2YXIgX3JlZiwgX3JlZjE7XG4gICAgY3ZjID0gJC50cmltKGN2Yyk7XG4gICAgaWYgKCEvXlxcZCskLy50ZXN0KGN2YykpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKHR5cGUpIHtcbiAgICAgIHJldHVybiBfcmVmID0gY3ZjLmxlbmd0aCwgX19pbmRleE9mLmNhbGwoKF9yZWYxID0gY2FyZEZyb21UeXBlKHR5cGUpKSAhPSBudWxsID8gX3JlZjEuY3ZjTGVuZ3RoIDogdm9pZCAwLCBfcmVmKSA+PSAwO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXR1cm4gY3ZjLmxlbmd0aCA+PSAzICYmIGN2Yy5sZW5ndGggPD0gNDtcbiAgICB9XG4gIH07XG5cbiAgJC5wYXltZW50LmNhcmRUeXBlID0gZnVuY3Rpb24obnVtKSB7XG4gICAgdmFyIF9yZWY7XG4gICAgaWYgKCFudW0pIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICByZXR1cm4gKChfcmVmID0gY2FyZEZyb21OdW1iZXIobnVtKSkgIT0gbnVsbCA/IF9yZWYudHlwZSA6IHZvaWQgMCkgfHwgbnVsbDtcbiAgfTtcblxuICAkLnBheW1lbnQuZm9ybWF0Q2FyZE51bWJlciA9IGZ1bmN0aW9uKG51bSkge1xuICAgIHZhciBjYXJkLCBncm91cHMsIHVwcGVyTGVuZ3RoLCBfcmVmO1xuICAgIGNhcmQgPSBjYXJkRnJvbU51bWJlcihudW0pO1xuICAgIGlmICghY2FyZCkge1xuICAgICAgcmV0dXJuIG51bTtcbiAgICB9XG4gICAgdXBwZXJMZW5ndGggPSBjYXJkLmxlbmd0aFtjYXJkLmxlbmd0aC5sZW5ndGggLSAxXTtcbiAgICBudW0gPSBudW0ucmVwbGFjZSgvXFxEL2csICcnKTtcbiAgICBudW0gPSBudW0uc2xpY2UoMCwgK3VwcGVyTGVuZ3RoICsgMSB8fCA5ZTkpO1xuICAgIGlmIChjYXJkLmZvcm1hdC5nbG9iYWwpIHtcbiAgICAgIHJldHVybiAoX3JlZiA9IG51bS5tYXRjaChjYXJkLmZvcm1hdCkpICE9IG51bGwgPyBfcmVmLmpvaW4oJyAnKSA6IHZvaWQgMDtcbiAgICB9IGVsc2Uge1xuICAgICAgZ3JvdXBzID0gY2FyZC5mb3JtYXQuZXhlYyhudW0pO1xuICAgICAgaWYgKGdyb3VwcyAhPSBudWxsKSB7XG4gICAgICAgIGdyb3Vwcy5zaGlmdCgpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGdyb3VwcyAhPSBudWxsID8gZ3JvdXBzLmpvaW4oJyAnKSA6IHZvaWQgMDtcbiAgICB9XG4gIH07XG5cbn0pLmNhbGwodGhpcyk7XG4iLCJyZXF1aXJlICdqcXVlcnkucGF5bWVudCdcblxuJCA9IGpRdWVyeVxuJC5jYXJkID0ge31cbiQuY2FyZC5mbiA9IHt9XG4kLmZuLmNhcmQgPSAob3B0cykgLT5cbiAgJC5jYXJkLmZuLmNvbnN0cnVjdC5hcHBseSh0aGlzLCBvcHRzKVxuXG5jbGFzcyBDYXJkXG4gIHRlbXBsYXRlOiBcIlwiXCJcbiAgPGRpdiBjbGFzcz1cImNhcmQtY29udGFpbmVyXCI+XG4gICAgICA8ZGl2IGNsYXNzPVwiY2FyZFwiPlxuICAgICAgICAgIDxkaXYgY2xhc3M9XCJmcm9udFwiPlxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImxvZ28gdmlzYVwiPnZpc2E8L2Rpdj5cbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJsb2dvIG1hc3RlcmNhcmRcIj5NYXN0ZXJDYXJkPC9kaXY+XG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwibG9nbyBhbWV4XCI+PC9kaXY+XG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwibG9nbyBkaXNjb3ZlclwiPmRpc2NvdmVyPC9kaXY+XG4gICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJsb3dlclwiPlxuICAgICAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInNoaW55XCI+PC9kaXY+XG4gICAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY3ZjIGRpc3BsYXlcIj7igKLigKLigKLigKI8L2Rpdj5cbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJudW1iZXIgZGlzcGxheVwiPuKAouKAouKAouKAoiDigKLigKLigKLigKIg4oCi4oCi4oCi4oCiwqDigKLigKLigKLigKI8L2Rpdj5cbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJuYW1lIGRpc3BsYXlcIj5GdWxsIG5hbWU8L2Rpdj5cbiAgICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9XCJleHBpcnkgZGlzcGxheVwiPuKAouKAoi/igKLigKI8L2Rpdj5cbiAgICAgICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICAgICAgPGRpdiBjbGFzcz1cImJhY2tcIj5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cImJhclwiPjwvZGl2PlxuICAgICAgICAgICAgICA8ZGl2IGNsYXNzPVwiY3ZjIGRpc3BsYXlcIj7igKLigKLigKI8L2Rpdj5cbiAgICAgICAgICAgICAgPGRpdiBjbGFzcz1cInNoaW55XCI+PC9kaXY+XG4gICAgICAgICAgPC9kaXY+XG4gICAgICA8L2Rpdj5cbiAgPC9kaXY+XG4gIFwiXCJcIlxuICBjYXJkVHlwZXM6IFtcbiAgICAnbWFlc3RybycsXG4gICAgJ2RpbmVyc2NsdWInLFxuICAgICdsYXNlcicsXG4gICAgJ2pjYicsXG4gICAgJ3VuaW9ucGF5JyxcbiAgICAnZGlzY292ZXInLFxuICAgICdtYXN0ZXJjYXJkJyxcbiAgICAnYW1leCcsXG4gICAgJ3Zpc2EnXG4gIF1cbiAgZGVmYXVsdHM6XG4gICAgZm9ybWF0dGluZzogdHJ1ZVxuICAgIGZvcm1TZWxlY3RvcnM6XG4gICAgICBudW1iZXJJbnB1dDogJ2lucHV0W25hbWU9XCJudW1iZXJcIl0nXG4gICAgICBleHBpcnlJbnB1dDogJ2lucHV0W25hbWU9XCJleHBpcnlcIl0nXG4gICAgICBjdmNJbnB1dDogJ2lucHV0W25hbWU9XCJjdmNcIl0nXG4gICAgICBuYW1lSW5wdXQ6ICdpbnB1dFtuYW1lPVwibmFtZVwiXSdcbiAgICBjYXJkU2VsZWN0b3JzOlxuICAgICAgY2FyZENvbnRhaW5lcjogJy5jYXJkLWNvbnRhaW5lcidcbiAgICAgIGNhcmQ6ICcuY2FyZCdcbiAgICAgIG51bWJlckRpc3BsYXk6ICcubnVtYmVyJ1xuICAgICAgZXhwaXJ5RGlzcGxheTogJy5leHBpcnknXG4gICAgICBjdmNEaXNwbGF5OiAnLmN2YydcbiAgICAgIG5hbWVEaXNwbGF5OiAnLm5hbWUnXG5cbiAgY29uc3RydWN0b3I6IChlbCwgb3B0cykgLT5cbiAgICBAb3B0aW9ucyA9ICQuZXh0ZW5kKHt9LCBAZGVmYXVsdHMsIG9wdHMpXG4gICAgQCRlbCA9IGlmICQoZWwpLmlzKCdmb3JtJykgdGhlbiAkKGVsKSBlbHNlICQoZWwpLmZpbmQgJ2Zvcm0nXG5cbiAgICB1bmxlc3MgQG9wdGlvbnMuY29udGFpbmVyXG4gICAgICBjb25zb2xlLmxvZyBcIlBsZWFzZSBwcm92aWRlIGEgY29udGFpbmVyXCJcbiAgICAgIHJldHVyblxuXG4gICAgQCRjb250YWluZXIgPSAkKEBvcHRpb25zLmNvbnRhaW5lcilcblxuICAgIEByZW5kZXIoKVxuICAgIEBhdHRhY2hIYW5kbGVycygpXG5cbiAgcmVuZGVyOiAtPlxuICAgIEAkY29udGFpbmVyLmFwcGVuZChAdGVtcGxhdGUpXG5cbiAgICAkLmVhY2ggQG9wdGlvbnMuY2FyZFNlbGVjdG9ycywgKG5hbWUsIHNlbGVjdG9yKSA9PlxuICAgICAgdGhpc1tcIiQje25hbWV9XCJdID0gQCRjb250YWluZXIuZmluZChzZWxlY3RvcilcblxuICAgICQuZWFjaCBAb3B0aW9ucy5mb3JtU2VsZWN0b3JzLCAobmFtZSwgc2VsZWN0b3IpID0+XG4gICAgICB0aGlzW1wiJCN7bmFtZX1cIl0gPSBAb3B0aW9uc1tuYW1lXSB8fCBAJGVsLmZpbmQoc2VsZWN0b3IpXG5cbiAgICBpZiBAb3B0aW9ucy5mb3JtYXR0aW5nXG4gICAgICBAJG51bWJlcklucHV0LnBheW1lbnQoJ2Zvcm1hdENhcmROdW1iZXInKVxuICAgICAgQCRleHBpcnlJbnB1dC5wYXltZW50KCdmb3JtYXRDYXJkRXhwaXJ5JylcbiAgICAgIEAkY3ZjSW5wdXQucGF5bWVudCgnZm9ybWF0Q2FyZENWQycpXG5cbiAgICBpZiBAb3B0aW9ucy53aWR0aFxuICAgICAgYmFzZVdpZHRoID0gcGFyc2VJbnQgQCRjYXJkQ29udGFpbmVyLmNzcygnd2lkdGgnKVxuICAgICAgQCRjYXJkQ29udGFpbmVyLmNzcyBcInRyYW5zZm9ybVwiLCBcInNjYWxlKCN7QG9wdGlvbnMud2lkdGggLyBiYXNlV2lkdGh9KVwiXG5cbiAgICAjIHNhZmFyaSBjYW4ndCBoYW5kbGUgdHJhbnNwYXJlbnQgcmFkaWFsIGdyYWRpZW50IHJpZ2h0IG5vd1xuICAgIGlmIG5hdmlnYXRvcj8udXNlckFnZW50XG4gICAgICB1YSA9IG5hdmlnYXRvci51c2VyQWdlbnQudG9Mb3dlckNhc2UoKVxuICAgICAgaWYgdWEuaW5kZXhPZignc2FmYXJpJykgIT0gLTEgYW5kIHVhLmluZGV4T2YoJ2Nocm9tZScpID09IC0xXG4gICAgICAgIEAkY2FyZC5hZGRDbGFzcyAnbm8tcmFkaWFsLWdyYWRpZW50J1xuXG4gIGF0dGFjaEhhbmRsZXJzOiAtPlxuICAgIEAkbnVtYmVySW5wdXRcbiAgICAgIC5iaW5kVmFsKFxuICAgICAgICBAJG51bWJlckRpc3BsYXksXG4gICAgICAgIHtcbiAgICAgICAgICBmaWxsOiBmYWxzZSxcbiAgICAgICAgICBmaWx0ZXJzOiB2YWxpZFRvZ2dsZXIoJ3ZhbGlkYXRlQ2FyZE51bWJlcicpXG4gICAgICAgIH1cbiAgICAgIClcbiAgICAgIC5vbiAncGF5bWVudC5jYXJkVHlwZScsIEBoYW5kbGUoJ3NldENhcmRUeXBlJylcblxuICAgIEAkZXhwaXJ5SW5wdXRcbiAgICAgIC5iaW5kVmFsKFxuICAgICAgICBAJGV4cGlyeURpc3BsYXksXG4gICAgICAgIHtcbiAgICAgICAgICBmaWx0ZXJzOiBbXG4gICAgICAgICAgICAodmFsKSAtPiB2YWwucmVwbGFjZSAvKFxccyspL2csICcnLFxuICAgICAgICAgICAgdmFsaWRUb2dnbGVyICd2YWxpZGF0ZUNhcmRFeHBpcnknXG4gICAgICAgICAgXVxuICAgICAgICB9XG4gICAgICApXG4gICAgICAub24gJ2tleWRvd24nLCBAaGFuZGxlKCdjYXB0dXJlVGFiJylcblxuICAgIEAkY3ZjSW5wdXRcbiAgICAgIC5iaW5kVmFsKEAkY3ZjRGlzcGxheSwgdmFsaWRUb2dnbGVyICd2YWxpZGF0ZUNhcmRDVkMnIClcbiAgICAgIC5vbignZm9jdXMnLCBAaGFuZGxlKCdmbGlwQ2FyZCcpKVxuICAgICAgLm9uKCdibHVyJywgQGhhbmRsZSgnZmxpcENhcmQnKSlcblxuICAgIEAkbmFtZUlucHV0XG4gICAgICAuYmluZFZhbCBAJG5hbWVEaXNwbGF5LCB7IGZpbGw6IGZhbHNlICB9XG5cbiAgaGFuZGxlOiAoZm4pIC0+XG4gICAgKGUpID0+XG4gICAgICAkZWwgPSAkKGUuY3VycmVudFRhcmdldClcbiAgICAgIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbCBhcmd1bWVudHNcbiAgICAgIGFyZ3MudW5zaGlmdCAkZWxcbiAgICAgIEBoYW5kbGVyc1tmbl0uYXBwbHkgdGhpcywgYXJnc1xuXG4gIGhhbmRsZXJzOlxuICAgIHNldENhcmRUeXBlOiAoJGVsLCBlLCBjYXJkVHlwZSkgLT5cbiAgICAgIHVubGVzcyBAJGNhcmQuaGFzQ2xhc3MoY2FyZFR5cGUpXG5cbiAgICAgICAgQCRjYXJkLnJlbW92ZUNsYXNzKCd1bmtub3duJylcbiAgICAgICAgQCRjYXJkLnJlbW92ZUNsYXNzKEBjYXJkVHlwZXMuam9pbignICcpKVxuXG4gICAgICAgIEAkY2FyZC5hZGRDbGFzcyhjYXJkVHlwZSlcbiAgICAgICAgQCRjYXJkLnRvZ2dsZUNsYXNzKCdpZGVudGlmaWVkJywgY2FyZFR5cGUgaXNudCAndW5rbm93bicpXG5cbiAgICBmbGlwQ2FyZDogKCRlbCwgZSkgLT5cbiAgICAgIEAkY2FyZC50b2dnbGVDbGFzcygnZmxpcHBlZCcpXG5cbiAgICBjYXB0dXJlVGFiOiAoJGVsLCBlKSAtPlxuICAgICAga2V5Q29kZSA9IGUua2V5Q29kZSBvciBlLndoaWNoXG4gICAgICByZXR1cm4gaWYga2V5Q29kZSAhPSA5IG9yIGUuc2hpZnRLZXlcbiAgICAgIHZhbCA9ICRlbC5wYXltZW50KCdjYXJkRXhwaXJ5VmFsJylcbiAgICAgIHJldHVybiB1bmxlc3MgdmFsLm1vbnRoIG9yIHZhbC55ZWFyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCkgaWYgISQucGF5bWVudC52YWxpZGF0ZUNhcmRFeHBpcnkodmFsLm1vbnRoLCB2YWwueWVhcilcblxuICAkLmZuLmJpbmRWYWwgPSAob3V0LCBvcHRzPXt9KSAtPlxuICAgIG9wdHMuZmlsbCA9IG9wdHMuZmlsbCB8fCBmYWxzZVxuICAgIG9wdHMuZmlsdGVycyA9IG9wdHMuZmlsdGVycyB8fCBbXVxuICAgIG9wdHMuZmlsdGVycyA9IFtvcHRzLmZpbHRlcnNdIHVubGVzcyBvcHRzLmZpbHRlcnMgaW5zdGFuY2VvZiBBcnJheVxuXG4gICAgJGVsID0gJCh0aGlzKVxuICAgIG91dERlZmF1bHRzID0gKG91dC5lcShpKS50ZXh0KCkgZm9yIG8sIGkgaW4gb3V0KVxuXG4gICAgJGVsLm9uICdmb2N1cycsIC0+XG4gICAgICBvdXQuYWRkQ2xhc3MgJ2ZvY3VzZWQnXG5cbiAgICAkZWwub24gJ2JsdXInLCAtPlxuICAgICAgb3V0LnJlbW92ZUNsYXNzICdmb2N1c2VkJ1xuXG4gICAgJGVsLm9uICdrZXl1cCcsIChlKSAtPlxuICAgICAgdmFsID0gJGVsLnZhbCgpXG5cbiAgICAgIGZvciBmaWx0ZXIgaW4gb3B0cy5maWx0ZXJzXG4gICAgICAgIHZhbCA9IGZpbHRlcih2YWwsICRlbCwgb3V0KVxuXG4gICAgICBmb3IgbywgaSBpbiBvdXRcbiAgICAgICAgaWYgb3B0cy5maWxsXG4gICAgICAgICAgb3V0VmFsID0gdmFsICsgb3V0RGVmYXVsdHNbaV0uc3Vic3RyaW5nKHZhbC5sZW5ndGgpXG4gICAgICAgIGVsc2VcbiAgICAgICAgICBvdXRWYWwgPSB2YWwgb3Igb3V0RGVmYXVsdHNbaV1cblxuICAgICAgICBvdXQuZXEoaSkudGV4dChvdXRWYWwpXG5cbiAgICAkZWxcblxuICB2YWxpZFRvZ2dsZXIgPSAodmFsaWRhdG9yTmFtZSkgLT5cbiAgICByZXR1cm4gKHZhbCwgJGluLCAkb3V0KSAtPlxuICAgICAgJG91dC50b2dnbGVDbGFzcygndmFsaWQnLCAkLnBheW1lbnRbdmFsaWRhdG9yTmFtZV0odmFsKSlcbiAgICAgIHZhbFxuXG4kLmZuLmV4dGVuZCBjYXJkOiAob3B0aW9uLCBhcmdzLi4uKSAtPlxuICBAZWFjaCAtPlxuICAgICR0aGlzID0gJCh0aGlzKVxuICAgIGRhdGEgPSAkdGhpcy5kYXRhKCdjYXJkJylcblxuICAgIGlmICFkYXRhXG4gICAgICAkdGhpcy5kYXRhICdjYXJkJywgKGRhdGEgPSBuZXcgQ2FyZCh0aGlzLCBvcHRpb24pKVxuICAgIGlmIHR5cGVvZiBvcHRpb24gPT0gJ3N0cmluZydcbiAgICAgIGRhdGFbb3B0aW9uXS5hcHBseShkYXRhLCBhcmdzKVxuIl19
